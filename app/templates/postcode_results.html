{% extends "base.html" %}
{% from "components/mini_card.html" import create_card with context %}

{%- block page_title -%}Daily update{% endblock %}
{%- block main -%}
	{% if area_info.ltla.startswith("E") %}
		{% set nameAttr = "msoaName" %}
		{% set codeAttr = "msoa" %}
		{% set areaType = "msoa" %}
	{% else %}
		{% set nameAttr = "ltlaName" %}
		{% set codeAttr = "ltla" %}
		{% set areaType = "ltla" %}
	{% endif %}
	<div class="local-intro govuk-!-margin-left-0">
		<h2 class="govuk-heading-l govuk-!-margin-bottom-2 govuk-!-margin-top-0 govuk-!-margin-left-0 govuk-!-padding-top-0 govuk-!-padding-left-0">
			{{ postcode }} &ndash; {{ area_info[nameAttr] }}
		</h2>
	</div>

	<div class="postcode-lead">
		<figure class="graph govuk-!-margin-bottom-2"
		        style="margin: 0;">
			<img src="https://coronavirus.data.gov.uk/public/assets/frontpage/map_thumbnails/{{ area_info[codeAttr] }}.svg"
			     style="max-width: min(400px, 100%); height: auto; border: 1px #f3f2f1 solid;"
			     alt="Scale showing the comparison of {{ postcode }} compared to national average."/>
		</figure>

		<div>
			{% include "components/alert_level.html" %}
			{% include "components/comparison_scale.html" %}
		</div>
	</div>

	<h3 class="govuk-!-margin-bottom-0 govuk-!-margin-top-5 govuk-heading-m">
		Additional relevant data available for {{ postcode }}:
	</h3>

	<p class="govuk-body-s govuk-!-margin-top-0 gray-text">
		Some data are not available at local levels &mdash; for example, healthcare data are only
		available by NHS region.
	</p>

	{% set R_growth_min = r_values.transmissionRateGrowthRateMin %}
	{% set R_growth_max = r_values.transmissionRateGrowthRateMax %}
	<p class="govuk-body-m govuk-!-margin-bottom-1">
		The latest R number for
		{% if area_info["ltla"][0] not in "NSW" -%}the healthcare region of{%- endif %}
		{{ area_info["nhsRegionName"] | default(area_info['nationName'], true) }} is estimated
		at&nbsp;<b>{{ r_values.transmissionRateMin }}&nbsp;to&nbsp;{{ r_values.transmissionRateMax }}</b>&nbsp;with
		a daily infection growth rate range
		of&nbsp;<b>
			{%- if R_growth_min > 0 -%}
				+{{ R_growth_min }}%
			{%- elif R_growth_min < 0 -%}
				&ndash;{{ R_growth_min }}%
			{%- else -%}
				{{ R_growth_min }}%
			{%- endif -%}
			&nbsp;to&nbsp;
			{%- if R_growth_max > 0 -%}
				+{{ R_growth_max }}%
			{%- elif R_growth_max < 0 -%}
				&ndash;{{ R_growth_max }}%
			{%- else -%}
				{{ R_growth_max }}%
			{%- endif -%}
		</b>.
	</p>

		<div class="card-container">
			{% for category, card in postcode_data.items() %}
				{{ create_card(card, True) }}
			{% endfor %}
		</div>

{%- endblock -%}

{%- block postcode_search_header -%}
	Search another location
{%- endblock -%}